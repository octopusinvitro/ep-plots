function createRequest(){var e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest,"undefined"!=typeof e.overrideMimeType&&e.overrideMimeType("application/json")):window.ActiveXObject?e=new ActiveXObject("Microsoft.XMLHTTP"):console.log("Connection error"),e}function get(e,t,n,r){var a=createRequest();a.onreadystatechange=function(){4===a.readyState&&200===a.status&&r(a.responseText,t,n)},a.open("GET",e,!0),a.send()}function itemsCount(e){return e.reduce(function(e,t){return e[t]=++e[t]||1,e},{})}function total(e){return Object.values(e).reduce(function(e,t){return e+t},0)}function stringsToIntegers(e){return e.map(function(e){return parseInt(e,10)})}function ageInYears(e){return today=new Date,msPerYear=31536e6,Math.floor((today-e)/msPerYear)}function guaranteedAge(e){return void 0===e?0:ageInYears(new Date(e))}function percentage(e,t){e[t]=e[t]||0;var n=100*Math.fround(e[t]/total(e));return n.toFixed(0)}function applyBinning(e,t){var n,r,a=stringsToIntegers(Object.keys(e))[0],o={};for(age in e)e.hasOwnProperty(age)&&(n=Math.floor((age-a)/t),r=a+n*t,o[r]=o[r]||0,o[r]+=e[age]);return o}function membershipsByTerm(e,t){return e.filter(function(e){return e.legislative_period_id===t})}function getParties(e){return e.map(function(e){return e.on_behalf_of_id})}function membershipsByParty(e){var t="";return e.reduce(function(e,n){return t=n.on_behalf_of_id,e[t]=e[t]||[],e[t].push(n),e},{})}function personIds(e){return e.map(function(e){return e.person_id})}function personsById(e,t){return e.filter(function(e){return t.some(function(t){return t===e.id})})}function personsByParty(e,t){var n={};for(var r in t)t.hasOwnProperty(r)&&(partyMemberIds=personIds(t[r]),n[r]=personsById(e,partyMemberIds));return n}function personsGenders(e){return e.map(function(e){return e.gender})}function genderCount(e){return itemsCount(personsGenders(e))}function gendersByParty(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=genderCount(e[n]));return t}function ages(e){return e.map(function(e){return guaranteedAge(e.birth_date)})}function agesByTerm(e,t){var n=membershipsByTerm(e.memberships,t),r=personsById(e.persons,personIds(n));return ages(r)}function gendersByTerm(e,t){var n=membershipsByTerm(e.memberships,t),r=personsById(e.persons,personIds(n));return r.map(function(e){return e.gender})}function totalGenders(e,t){var n=membershipsByTerm(e.memberships,t),r=membershipsByParty(n),a=personsByParty(e.persons,r);return gendersByParty(a)}function listOfUrls(e){return e.map(function(e){return'<li><a href="'+e+'">'+e+"</a></li>"}).join("")}function showSources(e,t){document.getElementById(t).innerHTML=listOfUrls(e.meta.sources)}function showCountriesSources(e,t){e.map(function(e){showSources(e.data,t+e.name.toLowerCase())})}function display(e){return"0"===e?"?":e}function object2list(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t+="<li><strong>"+n+":</strong> "+e[n]+"</li>");return t}function object2datalist(e){var t,n,r=document.createDocumentFragment();for(var a in e)e.hasOwnProperty(a)&&(n=percentage(e,a),t=document.createElement("dd"),t.className="bar percentage-"+n,t.innerHTML='<span class="bar-text">'+a+": "+n+"%</span>",r.appendChild(t));return r}function object2rect(e,t,n,r){var a="http://www.w3.org/2000/svg",o=percentage(e,t),s=document.createElementNS(a,"g");return s.innerHTML='<text class="svg-bar__text" y="'+(10+n)+'" dy=".35em">'+t+'</text><text class="svg-bar__text" y="'+(10+n)+'" dy=".35em" x="80">'+o+'%</text><rect class="svg-bar__bar" width="'+5*o+'" height="30" x="150" y="'+r+'"></rect>',s}function object2svg(e){var t=document.createDocumentFragment(),n=10,r=0;for(var a in e)e.hasOwnProperty(a)&&(t.appendChild(object2rect(e,a,n,r)),n+=40,r+=40);return t}function gender2list(e){var t=total(e)-e.male-e.female;return"<li><strong>Male count:</strong> "+e.male+"</li><li><strong>Female count:</strong> "+e.female+"</li><li><strong>Other/Unknown:</strong> "+t+"</li>"}function age2display(e,t){var n=void 0===t?"+":" - "+(t-1);return 0===e?"unknown":e+n}function drawSVGBars(e,t,n,r){var a=t[e];return'<g transform="translate('+n+',0)"><rect class="svg-sparklines__bar" height="'+a+'" y="'+(40-a)+'" width="'+r+'"></rect><text class="svg-sparklines__text" x="1" y="44">'+display(e)+"</text></g>"}function ages2list(e){var t,n,r="",a=stringsToIntegers(Object.keys(e));for(t=a[0],n=a.slice(-1)[0];t<n;t++)e.hasOwnProperty(a[t])&&(r+="<li>Age "+age2display(a[t],a[t+1])+": "+e[a[t]]+" members.</li>");return r}function ages2sparkLines(e){var t=10,n="",r=2,a=applyBinning(e,t);for(age in a)a.hasOwnProperty(age)&&(n+='<span class="sparklines-index"><span class="count" style="height: '+a[age]*r+'%;"><span>'+display(age)+"</span></span>,</span> ");return n}function ages2sparkLinesSVG(e,t){var n=10,r="",a=0,o=6,s=applyBinning(e,n);for(age in s)s.hasOwnProperty(age)&&(r+=drawSVGBars(age,s,a,o),a+=o);return r}function country2row(e,t,n,r){var a=document.createElement("tr");return a.id="row-"+r,a.className="country-row",a.innerHTML='<th scope="row">'+e.name+'</th><td class="male bar-tables"   style="height: '+2.5*t+'px"><p>'+t+'%</p></td><td class="female bar-tables" style="height: '+2.3*n+'px"><p>'+n+"%</p></td>",a}function array2paragraphs(e){var t,n=document.createDocumentFragment();return e.map(function(e){t=document.createElement("p"),t.innerHTML="<strong>Term "+e.term+":</strong> "+e.female+" of "+e.total+".",n.appendChild(t)}),n}function counts2points(e){var t=0,n="";return e.map(function(e){t++,n+='<circle cx="'+(150*t-50)+'" cy="'+(370-4.8*e.female)+'" data-value="'+e.female+'" r="4"></circle>'}),n}function setActiveClass(e,t){for(var n=0,r=e.children.length;n<r;n++)e.children[n].classList.remove("active"),t.classList.add("active")}function showGenderByPartyCounts(e){var t=percentage(e,"male"),n=percentage(e,"female"),r=percentage(e,"undefined");document.getElementById("male").style.strokeDasharray=t+" 100",document.getElementById("female").style.strokeDasharray=n+" 100",document.getElementById("female").style.strokeDashoffset=-t,document.getElementById("male-perc").innerHTML=t+"%",document.getElementById("female-perc").innerHTML=n+"%",document.getElementById("other-perc").innerHTML=r+"%"}function createButtons(e,t){var n,r=document.createDocumentFragment(),a=document.getElementById(t),o=Object.keys(e);o.map(function(e){n=document.createElement("button"),n.innerText=e,"_IND"===e&&(n.innerText="NO PARTY"),n.setAttribute("data-party",e),r.appendChild(n)}),a.appendChild(r),a.addEventListener("click",function(t){if(t.target!=t.currentTarget){var n=t.target,r=n.getAttribute("data-party");showGenderByPartyCounts(e[r]),setActiveClass(a,n)}t.stopPropagation()}),showGenderByPartyCounts(e[Object.keys(e)[0]]),setActiveClass(a,a.children[0])}function createAgesParagraph(e,t){var n=document.createElement("p");return n.innerHTML="<strong>Term:</strong> "+t.replace("term/","")+". <strong>Total members:</strong> "+e.length+".",n}function createAgesList(e,t){var n=document.createElement("ul");return n.innerHTML=ages2list(applyBinning(itemsCount(e),t)),n}function createSparkItems(e,t,n){var r=document.createElement("li"),a=n+t.replace("term/","")+".html";return r.innerHTML='<a href="'+a+'">'+t+'</a><span class="sparkline">'+ages2sparkLines(itemsCount(agesByTerm(e,t)))+"</span>",r}function createSparkItemsSVG(e,t,n){var r=document.createElement("li"),a=t.replace("term/",""),o=n+a+".html";return r.innerHTML='<span class="svg-sparklines__term"><a href="'+o+'">Term '+a+'</a></span><svg version="1.1" xmlns="http://www.w3.org/2000/svg"class="chart" viewBox="0 0 45 55" aria-labelledby="title" role="img">  <title id="title">A bar chart showing frequency of ages for term '+a+"</title>"+ages2sparkLinesSVG(itemsCount(agesByTerm(e,t)),o)+"</svg>",r}function genderCounts(e,t){var n;return t.map(function(t){return n=itemsCount(gendersByTerm(e,t)),{term:t,female:n.female,total:total(n)}})}function showCountInSVG(e,t,n){var r=itemsCount(getParties(membershipsByTerm(e.memberships,t)));document.getElementById(n.bars).appendChild(object2svg(r)),document.getElementById(n.partyCount).innerHTML=object2list(r),document.getElementById(n.totalCount).innerHTML=total(r)}function showCount(e,t,n){var r=itemsCount(getParties(membershipsByTerm(e.memberships,t)));document.getElementById(n.bars).appendChild(object2datalist(r)),document.getElementById(n.partyCount).innerHTML=object2list(r),document.getElementById(n.totalCount).innerHTML=total(r)}function showCounts(e,t,n){var r,a=10,o=document.createDocumentFragment();t.map(function(t){r=agesByTerm(e,t),r.sort(),o.appendChild(createAgesParagraph(r,t)),o.appendChild(createAgesList(r,a))}),document.getElementById(n).appendChild(o)}function showFemaleCounts(e,t,n){document.getElementById(n).appendChild(array2paragraphs(genderCounts(e,t)))}function showTotals(e,t){e.map(function(e){document.getElementById(t+e.name.toLowerCase()).innerHTML=total(itemsCount(gendersByTerm(e.data,e.term)))})}function showGenderCounts(e,t){e.map(function(e){document.getElementById(t+e.name.toLowerCase()).innerHTML=gender2list(itemsCount(gendersByTerm(e.data,e.term)))})}function showBars(e){var t,n,r=0,a=document.createDocumentFragment();e.map(function(e){counts=itemsCount(gendersByTerm(e.data,e.term)),t=percentage(counts,"male"),n=percentage(counts,"female"),r++,a.appendChild(country2row(e,t,n,r))}),document.querySelector("#table-bar-chart tbody").appendChild(a)}function showSparklist(e,t,n,r){var a=document.createDocumentFragment();t.map(function(t){a.appendChild(createSparkItems(e,t,n))}),document.getElementById(r).appendChild(a)}function showSparklistSVG(e,t,n,r){var a=document.createDocumentFragment();t.map(function(t){a.appendChild(createSparkItemsSVG(e,t,n))}),document.getElementById(r).appendChild(a)}function showPoints(e,t,n){document.getElementById(n).innerHTML=counts2points(genderCounts(e,t))}!function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],r=n.length,a=window.console=window.console||{};r--;)e=n[r],a[e]||(a[e]=t)}();
//# sourceMappingURL=main.js.map
